# 死锁

**死锁**是指多个进程循环等待彼此占有的资源而无限期的僵持下去的情况

## 产生原因

- 系统资源不足
- 进程运行推进的顺序不合适
- 资源分配不当



## 必要条件

- **互斥条件**

    一个资源每次只能被一个进程使用

- **请求与保持条件**

    一个进程因请求资源而阻塞时，对已获得的资源保持不放

- **不剥夺条件**

    进程已获得的资源，在未使用完之前，不能强行剥夺

- **循环等待条件**

    若干进程之间形成一种头尾详解的循环等待资源关系

    

## 解决方案

### 预防死锁

- **资源一次性分配**

    破坏请求和保持条件。当某个资源只在进程结束时使用一小会，那么在进程运行期间，这个资源都被占用，资源利用率很低。比较好的方法是，进程开始时，只申请和使用进程启动的资源，在运行过程中不断申请新的资源，同时释放已经使用完的资源。

- **可剥夺资源**

    当进程新申请的资源不满足时，释放已经分配的资源。破坏不可剥夺条件。

- **资源有序分配**

    系统给进程编号，按顺序申请资源，释放资源则反序释放。破坏循环等待条件

### 避免死锁

在进程每次申请资源时判断这些操作是否安全，如银行家算法

### 检测死锁

建立资源分配表和进程等待表

### 解除死锁

- **资源剥夺法。**挂起某些思索进程，并抢占它的资源，将这些资源分配给其他的死锁进程。但应防止被挂起的进程长时间得不到资源时，而处于资源匮乏的状态。

- **进程撤销法。**强制撤销一个或一部分进程并剥夺这些进程的资源。撤销的原则可以按进程的优先级和撤销进程代价的高低进行。

- **进程回退法。**让一个或多个进程回退到足以回避死锁的地步，进程回退时资源释放资源而不是被剥夺。要求系统保持进程的历史信息，设置还原点。