# B树和B+树



## B树

### 介绍

B树即平衡多路查找树，是一颗M叉查找树，并且所有叶子节点位于同一层。

为了描述B-Tree，首先定义一条数据记录为一个二元组**[key, data]**，key为记录的键值，对于不同数据记录，key是互不相同的；**data**为数据记录除key外的数据。那么B-Tree是满足下列条件的数据结构：

- **d** 是一个大于 1 的正整数，成为 B 树的**度**
- **h**是一个正整数，称为 B 树的**高度**
- 每个非叶子节点由 n - 1 个 key 和 n 个指针组成， $ d \leq n \leq 2d $
- 每个叶子节点最少包含一个 key 和两个指针，最多包含 **2d - 1** 个 key 和 **2d** 个指针，叶子节点指针均为 null
- 所有叶子节点具有相同深度，等于树高 **h**
- key 和指针互相间隔，节点两端是指针
- 一个节点的 key 从左到右非递减排列
- 每个节点要么为 null，要么指向另一个节点
- 如果某个指针在节点最右边且不为 null，则其指向节点的所有 key 的值大于该节点最后一个 key 的值
- 如果某个指针在节点最左边且不为 null，则其指向节点的所有 key 的值小于该节点第一个 key 的值
- 如果某个指针在节点左右相邻的 key 分别是 key<sub>i</sub> 和 key<sub>i + 1</sub> 且不为 null，则其指向节点的所有 key 的值大于 key<sub>i</sub> 的值且小于key<sub>i + 1</sub>的值

### 查找

在B-Tree中按key检索数据的算法非常直观：首先从根节点进行二分查找，如果找到则返回对应节点的data，否则对相应区间的指针指向的节点递归进行查找，直到找到节点或找到null指针，前者查找成功，后者查找失败。

![](C:\Users\panda\Documents\基础知识笔记\Resources\B-Tree.png)

## B+树

B+树基于B树和叶子节点顺序访问指针进行实现，具有B树的平衡性，并且通过叶子节点顺序访问指针来提高区间查询的性能，一个叶子节点中的key从左到右非递减排列

- 非叶子节点中含有n个key，用来索引，所有 data 都保存在叶子节点
- 有的叶子节点包含全部 key 的信息，以及指向含这些 key 记录的指针
- 所有非叶子节点可以看成是索引部分，节点中仅含其子树中最大或最小关键字

- 同一个数字会在不同节点中重复出现，根节点的最大元素就是 B+ 树最大元素。

![](C:\Users\panda\Documents\基础知识笔记\Resources\B+Tree.png)

## Reference

- http://blog.codinglabs.org/articles/theory-of-mysql-index.html